# 객체지향의 사실과 오해 - 역활, 책임, 협력 관점에서 본 객체지향

## 07. 함께 모으기

<p>
  개념 관점(Conceptual Perspective)에서 설계는 도메인 안에 존재하는 개념과 개념들 사이의 관계를 표현한다. 도메인이란 사용자들이 관심을 가지고 있는 특정 분야나 주제를 말하며 소프트웨어는 도메인에 존재하는 문제를 해결하기 위해 개발된다. 이 관점은 사용자가 도메인을 바라보는 관점을 반영한다. 따라서 실제 도메인의 구칙과 제약을 최대한 유사하게 반영하는 것이 핵심이다.
</p>

<p>
  명세 관점(Specification Perspective)에 이르면 사용자의 영역인 도메인을 벗어나 개발자의 영역인 소프트웨어로 초점이 옮겨진다. 명세 관점은 도메인의 개념이 아니라 실제로 소프트웨어 안에서 살아 숨쉬는 객체들의 책임에 초점을 맞추게 된다. 즉, 객체의 인터페이스를 바라보게 된다. 명세 관점에서 프로그래머는 객체가 협력을 위해 무엇을 할 수 있는가에 초점을 맞춘다.
</p>

<p>
  구현 관점(Implementation Perspective)은 실제 작업을 수행하는 코드와 연관돼 있다. 구현 관점의 초점은 객체들이 책임을 수행하는 데 필요한 동작하는 코드를 작성하는 것이다. 따라서 프로그래머는 객체의 책임을 어떻게 수행할 것인가에 초점을 맞추며 인터페이스를 구현하는 데 필요한 속성과 메서드를 클래스에 추가한다.
</p>

### 커피 전문점 도메인

#### 커피 주문

<img width="266" alt="스크린샷 2022-02-06 오후 5 52 45" src="https://user-images.githubusercontent.com/38815618/152673930-8f0b8c66-14fc-411a-ace5-087d8191055c.png">

<p>
  메뉴판 타입에서 메뉴 항목 타입 쪽으로 향하는 선에 그려진 속이 찬 마름모는 포함(containment) 관계 또는 합성(composition) 관계를 나타낸다. 손님 타입과 메뉴판 타입에서 연결된 선은 한 타입의 인스턴스가 다른 타입의 인스턴스를 포함하지는 않지만 서로 알고 있어야 하는 연관(association) 관계라고 한다.
</p>

<p>
  도메인 모델을 작성하는 단계에서 어떤 관계가 포함 관계이고 어떤 관계가 연관 관계인지는 중요하지 않다. 초점은 어떤 타입이 도메인을 구성하느냐와 타입들 사이에 어떤 관계가 존재하는지를 파악함으로써 도메인을 이해하는 것이다.
</p>

### 설계하고 구현하기

#### 커피를 주문하기 위한 협력 찾기

<p>
  협력을 설계할 때는 객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택하게 해야 한다. 이는 메시지를 먼저 선택하고 그 후에 메시지를 수신하기에 적절한 객체를 선택해야 한다는 것을 의미한다. 이제 메시지를 수신할 객체는 메시지를 처리할 책임을 맡게 되고 객체가 수신하는 메시지는 객체가 외부에 제공하는 공용 인터페이스에 포함된다.
</p>

<img width="181" alt="스크린샷 2022-02-06 오후 6 13 57" src="https://user-images.githubusercontent.com/38815618/152674464-d8983a01-dd10-4a5b-8b36-de109550c30f.png">

<p>
  메시지 위에 붙은 화살표는 메시지에 담아 전달될 부가적인 정보인 인자를 의미한다. 메시지를 처리할 객체는 손님 타입의 인스턴스다.
</p>

<p>
  협력을 가시화하기 위해 사용한 표기법은 UML 표준이 아니다. UML 2.0 표준에서는 협력을 표현하기 위한 용도로 커뮤니케이션 다이어그램(Communiaction Diagram)을 제공한다. 여기서 커뮤니케이션 다이어그램과 유사하지만 약간 다른 표기법을 사용한 이유는 메시지의 방향과 주고받는 데이터를 좀 더 보기 쉽게 표현하기 싶기 때문이다.
</p>

#### 구현하기

```java
// 예시

public class MenuItem {
  private String name;
  private int price;

  public MenuItem(String name, int price) {
    this.name = name;
    this.price = price;
  }

  public int cost() {
    return price;
  }

  public String getName() {
    return name;
  }
}
```

### 코드와 세 가지 관점

#### 코드는 세 가지 관점을 모두 제공해야 한다

<p>
  개념 관점, 명세 관점, 구현 관점은 동일한 코드를 바라보는 서로 다른 관점이다. 훌륭한 객체지향 프로그래머는 하나의 클래스 안에 세 가지 관점을 모두 포함하면서도 각 관점에 대응되는 요소를 명확하고 깔끔하게 드러낼 수 있다.
</p>

#### 도메인 개념을 참조하는 이유

<p>
  소프트웨어는 항상 변한다. 설계는 변경을 위해 존재한다. 여러 개의 클래스로 기능을 분할하고 클래스 안에서 인터페이스와 구현을 분리하는 이유는 변경이 발생했을 때 코드를 좀 더 수월하게 수정하길 간절히 원하기 때문이다. 소프트웨어 클래스가 도메인 개념을 따르면 변환에 쉽게 대응할 수 있다.
</p>

#### 인터페이스와 구현을 분리하라

<p>
  명세 관점은 클래스의 안정적인 측면을 드러내야 한다. 구현 관점은 클래스의 불안정한 측면을 드러내야 한다. 인터페이스가 구현 세부 사항을 노출하기 시작하면 아주 작은 변동에도 전체 협력이 요동치는 취약한 설계를 얻을 수밖에 없다.
</p>

<p>
  마틴 파울러는 개념적인 관점과 명세 관점 사이는 그렇게 중요하지 않은 경우가 많지만 명세 관점과 구현 관점을 분리하는 것은 매우 중요하다고 주장한다. 프로그래머의 입장에서 가장 많이 접하게 되는 것은 코드이므로 구현 관점을 가장 빈번하게 사용하겠지만 실제로 훌륭한 설계를 결정하는 측면은 명세 관점인 객체의 인터페이스다. 명세 관점이 설계를 주도하게 하면 설계의 품질이 향상될 수 있다는 사실을 기억한다.
</p>
